<!DOCTYPE html>
<html lang="en_US" xmlns="https://html.spec.whatwg.org/multipage/">
<head>
    <meta charset="utf-8" />
    <title>sm64js</title>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-178244102-1"></script>
    <script>
        window.dataLayer = window.dataLayer || []
        function gtag() { dataLayer.push(arguments) }
        gtag('js', new Date())

        gtag('config', 'UA-178244102-1')
    </script>
    <script src="https://cdn.jsdelivr.net/npm/@jaames/iro@5"></script>

</head>

<body class="text-center">
    <canvas hidden id="fullCanvas" width="1280" height="720" style="background-color: black;"></canvas>

    <!-- Nav bar -->
    <header>
        <nav>
            <a href="https://vanilla.sm64js.com">Vanilla</a>
            <a href="https://60fps.sm64js.com">60 FPS</a>
            <a href="credits.html">About & Credits</a>
            <a href="https://github.com/sm64js/sm64js">Source Code</a>
            <a href="https://github.com/sm64js/sm64js/issues">GitHub Issues</a>
            <a href="https://discord.gg/7UaDnJt">Discord Server</a>
        </nav>
    </header>


    <!-- Main content of the site-->
    <main hidden id="mainContent">

        <!-- Title -->
       <img id="title" src="/mmo/assets/title.png">

        <!-- Description -->
       <h6 class="description">This project is currently still being developed. This page may be live from time to time for testing, but there may be glitches and performance issues. The server will go down and restart at random times without warning. If you would like to help with the project or have feedback please<a class="descriptionContact" href="/credits.html">contact me.</a></h6>
       <h6 class="description">Screen transitions in 4:3 are messed up due to widescreen now being implemented. <br> <span style="font-size: 0.94em;">The chat will appear below the game when in widescreen mode, this will get fixed on a future update.</span></h6>
       

       <!-- Submit ROM form -->
       <form id="romSelect">
                <h4 class="romSelectText">Select US sm64 (z64) ROM File from your computer</h4>
                <input id="romFile" class="romFileText" type="file">
                <input class="green-button loadRomButton" type="submit" value="Load ROM">
            </form>

        <h6 id="romMessage" class="romMessageText">This project uses the textures and other game assets from the original game. Due to copyright issues, I cannot host those assets on this site. Please select a sm64 ROM to extract those assets before you can play.</h6>

        <!-- Pop up -->
        <div id="rules">
            <br>
            <img src="/mmo/assets/sm64js_d.svg" class="rulesLogo" alt="sm64js Logo">
            <br>
            <p style="text-align: center;">Welcome to the multiplayer version of sm64js! To play you have to follow the listed rules below.</p>
            <br>
            <p>Treat all users with respect.</p>
            <p>Keep chat messages appropriate, no swearing. Make sure to keep conversations safe/appropriate for work/school.</p>
            <p>Inappropriate or offensive behavior may result in temporary or permanent mute or ban</p>
            <p>Failure to comply with these rules will result in punishment, including but not limited to a mute or ban of your account.</p>
        
            <button type="button" class="rulesButton" id="acceptRules">I have read the rules and will follow them.</button>
        </div>

        <br />
        <br />
        <!-- Start of signboxBackground -->
        <div id="signboxBackground" class="shunned">
            <!-- Main buttons & settings -->
            <!-- Divs are used as rows here -->
            <div>  <!-- This is row 1 for example -->
                <button id="startbutton" type="button" class="green-button" disabled>Start Game</button>
                <button class="pink-button" onclick="window.hideHUD(this)">Hide HUD</button>
                <button class="blue-button fixButtonPadding" onclick="window.myMario.freezeCamera = !window.myMario.freezeCamera; this.textContent = window.myMario.freezeCamera ? 'Freeze Camera (ON)' : 'Freeze Camera (OFF)'">Freeze Camera (OFF)</button>
            </div>

            <!-- Sign in / sign out section, Map select-->
            <div id="signinSection">
                <!-- Sign in buttons -->
                <div id="signinButtons" style="justify-content:center; margin-top: 10px;">
                    <img style="cursor: pointer;" id="discordSigninButton" src="/mmo/assets/discord_signin.png" width="240" style="margin-left:15px;">
                    <img style="cursor: pointer;" id="googleSigninButton" src="/mmo/assets/google_signin.png" width="240" style="margin-left:15px;">
                </div>

                <!-- Sign out button -->
                <button hidden id="logoutButton" type="submit" class="red-button" style="height:50px; margin-top: 5px">
                    <b>Sign out</b>
                </button>

                <!-- Player name section -->
                <div hidden id="playerNameRow">
                    <form id="playerNameForm">

                        <!-- Discord name -->
                        <div id="discordNameRow">
                                <label type="text">Discord Name: </label>

                                <input readonly id="discordNameBox" type="text" style="max-width: 200px" minlength="3" maxlength="20">

                                <button id="switchCustom" type="button" class="yellow-button fixButtonPadding">Use Custom Name</button>

                        </div>
                        <!-- End discord name -->

                        <!-- Custom name -->
                        <div hidden id="customNameRow">
                                <label type="text">Custom Name: </label>

                                <input id="playerNameInput" type="text" minlength="3" maxlength="14" placeholder="Enter name here" onchange="window.updatePlayerName(this.value)">

                                <button id="switchDiscord" type="button" class="blue-button fixButtonPadding">Use Discord Name</button>

                        </div>
                        <!-- End custom name -->
                        <!-- Map select -->
                        <div class="mapSelectDiv">

                                <label type="text" readonly>Select Map: </label>
                                <br>

                            <!-- Map selection list, add newer custom levels in here -->
                            <div>

                                <select id="mapSelect">
                                    <optgroup label="Vanilla maps">
                                        <option value="16"> Castle Grounds </option>
                                        <option value="6"> Castle Inside First Level </option>
                                        <option value="602"> Castle Inside Second Level </option>
                                        <option value="26"> Castle Courtyard </option>
                                        <option value="9"> Bob-omb Battlefield </option>
                                        <option value="24"> Whomp's Fortress </option>
                                        <option value="5"> Cool, Cool Mountain </option>
                                        <option value="56"> Cool, Cool Mountain Slide </option>
                                        <option value="27"> Princess's Secret Slide </option>
                                        <option value="4"> Big Boo's Haunt </option>
                                        <option value="7"> Hazy Maze Cave </option>
                                        <option value="8"> Shifting Sand Land </option>
                                        <option value="36"> Tall, Tall Mountain </option>
                                        <option value="10"> Snowman's Land </option>
                                    </optgroup>

                                    <optgroup label="Custom maps">
                                        <option value="1000"> Mushroom Battlefield </option>
                                        <option value="1004"> Mushroom Raceway </option>
                                        <option value="1006"> Dolphin Town </option>
                                        <option value="1001"> CTF/Race Map </option>
                                        <option value="1002"> Starman Fortress </option>
                                        <option value="1003"> Glider Jungle </option>
                                        <option value="999"> Clouded Ruins </option>
                                    </optgroup> 

                                </select>

                                <button id="playerNameButton" type="submit" class="green-button">
                                    Submit
                                </button>

                            </div>


                            <div>
                                <label id="playerNameResult" type="text" readonly style="display: none;">Waiting for selection</label>
                            </div> <!-- If this isn't even used anymore wiy bother hiding it? Does a js reference it or something? -eros -->
                            
                            
                            
                        </div>
                        <!-- End map select -->

                    </form>
                </div> <!-- End player name section -->

                <!-- Authentification failed message -->
                <h6 hidden id="authFailMsg" style="color:red"></h6> <!-- This is row 2 and so on -->
            </div>

            <!-- In-game options -->
                <div>
                                <button type="button"
                                    id="pvpButton"
                                    class="pink-button"
                                    onclick="window.togglePvp()"
                                    >
                                    PvP: On
                                </button>
                                <button type="button"
                                    id="respawnButton"
                                    class="blue-button"
                                    onclick="window.reset = true">
                                    Respawn
                                </button>
                            </div>

                <!-- Controls and customization -->
                <div id="yellowControls">
                                <button type="button"
                                        class="green-button fixButtonPadding"
                                        data-placement="bottom"
                                        onclick="window.switchbox('controlsbox')">
                                    Customize Controls
                                </button>

                                <button type="button"
                                        class="blue-button fixButtonPadding"
                                        onclick="window.switchbox('optionsbox')">
                                    Options & Misc
                                </button>

                                <button type="button"
                                    class="pink-button fixButtonPadding"
                                    onclick="window.switchbox('customizebox'); window.updateWheel()">
                                    Customize Character / Skin
                                </button>
                            </div>

        </div>
        <!-- End of signboxBackground -->
        <!-- Start of options box-->
        <div hidden id="optionsBackground">
            <h1>Options & Misc</h1>
            <!-- Miscellaneous -->
            <!-- Divs are used as rows here -->
            <div> <!-- This is row 1 for example -->
                <button id="deleteRom" type="button" class="red-button">Delete Rom</button>
            </div>
            
            <div>   <!-- This is row 2 and so on -->
                <button type="button"
                        class="blue-button"
                        onclick="window.fullWindowMode = true">
                    Full Window Mode
                </button>
                <button type="button"
                    class="blue-button"
                    onclick="window.toggleFullscreen()">
                    Fullscreen Mode
                </button>
                <button type="button"
                    class="blue-button"
                    onclick="window.toggleWidescreen()">
                    Widescreen Mode
                </button>
            </div>
                <!-- Color code pop up -->
                <div id="colorCodePasteWindow">
                    <label>Gameshark Color Code Importer:</label>
                    <br>
                    <br>
                    <div>
                        <textarea id="ccPasteArea" placeholder="Enter your Color Code here..." rows="6" style="resize: none;"></textarea>
                    </div>
                    <br>
                    <div>
                        <button class="blue-button"
                            onclick="window.myMario.skinData = window.parseColorCode(document.getElementById('ccPasteArea').value); document.getElementById('ccPasteArea').value = ''">
                            Import Color Code
                        </button>
                    </div>
                </div>

            <!-- Controls and customization -->
            <div id="blueControls">
                <button type="button"
                        class="green-button fixButtonPadding"
                        onclick="window.switchbox('controlsbox')">
                    Customize Controls
                </button>
                <button type="button"
                        class="yellow-button"
                        onclick="window.switchbox()">
                    Return
                </button>
                <button type="button"
                    class="pink-button fixButtonPadding"
                    onclick="window.switchbox('customizebox'); window.updateWheel()">
                    Customize Character / Skin
                </button>
            </div>
        </div>
        <!-- End of options -->

        <!-- Start of customize skin menu -->

        <div hidden id="customizeBackground">
            <div id="skinCustomizerWindow">
                <!-- Skin presets -->
                <div>
                    <label>Select Skin Preset & Character:</label>

                    <div>
                        <select class="form-control" id="presetBox" onchange="window.updateSkinID(this.value); localStorage.setItem('presetBox', this.value)" style="font-family: 'TextboxFont'; height: 2rem;">
                            <optgroup label="Main Color Codes">
                                <option value="0">Mario Colors</option>
                                <option value="1">Luigi Colors</option>
                            </optgroup>
                            <optgroup label="Other Color Codes">
                                <option value="2">SMB3 Mario</option>
                                <option value="3">SMB3 Luigi</option>
                                <option value="4">Waluigi</option>
                                <option value="5">7 GRAND DAD</option>
                                <option value="6">Super Show Mario</option>
                                <option value="7">Super Show Luigi</option>
                                <option value="8">Rainbow Mario</option>
                            </optgroup>
                        </select>
                        <select id="characterType" style="width:120px; height: 2rem; font-family: 'TextboxFont';" onchange="window.setCharacter(this.value)">
                            <option value="0">Mario</option>
                            <option value="1">Luigi</option>
                        </select>
                    </div>
                </div>

                <br>

            <!-- Options -->
                <!-- Player part selector -->
                <div>
                <select id = "skinTypes" onchange="window.updateWheel()"> 
                    <option value = "overalls">Overalls</option>
                    <option value="hat">Hat</option> 
                    <option value = "shirt" >Shirt</option>
                    <option value="gloves">Gloves</option >
                    <option value = "boots">Boots</option>
                    <option value="skin">Skin</option>
                    <option value = "hair">Hair</option>
                    <option value = "parachute">Glider & Kart</option>
                </select>
                </div>

                <br>

                <!-- Ambient color checkbox -->
                <div>
                    <input type="checkbox" id="updateAmb" checked>
                    <label>Update ambient color accordingly to main color? </label>
                </div>

                <br />

                <!-- Hat toggle -->
                <div>

                <button class="green-button" onclick="window.toggleCapState()">Toggle Hat</button>
                </div>
                <!-- Color pickers -->
                <div class="colorPickersContainer">
                    <div id="picker"></div>
                    <div id="ambpicker"></div>
                </div>

            </div>
                <!-- Controls and customization -->
                <div id="pinkControls">
                    <button type="button"
                            style="margin-top: -800px;"
                            class="green-button"
                            onclick="window.switchbox('controlsbox')">
                        Customize Controls
                    </button>
                    <button type="button"
                            class="blue-button"
                            style="margin-top: -800px;"
                            onclick="window.switchbox('optionsbox')">
                        Options & Misc
                    </button>
                    <button type="button"
                        class="yellow-button"
                        style="margin-top: -800px;"
                        onclick="window.switchbox()">
                        Return
                    </button>
                </div>
            </div>
            <!-- End of skin customizer pop up -->

        </div>

        <!-- End of options box -->
        <!-- Start of controls box -->
        <div hidden id="controlsBackground">
            <h6 style="text-align:center; font-size: 30px;" id="noGamepadMessage">No Gamepad Detected Yet</h6>
            <div id="keyboardControlsWindow">

                <!-- Keyboard control list -->
                <div style="float:left;">
                        <div>
                            <label style="padding-right:30px">Start:</label>
                            <select keyboardButton name="start" onchange="window.updateKeyboardMapping(this.value, this.name)"></select>
                        </div>

                        <div>
                            <label style="padding-right:30px">A:</label>
                            <select keyboardButton name="a" onchange="window.updateKeyboardMapping(this.value, this.name)"></select>
                        </div>

                        <div>
                            <label style="padding-right:30px">B:</label>
                            <select keyboardButton name="b" onchange="window.updateKeyboardMapping(this.value, this.name)"></select>
                        </div>

                        <div>
                            <label style="padding-right:30px">Z:</label>
                            <select keyboardButton name="z" onchange="window.updateKeyboardMapping(this.value, this.name)"></select>
                        </div>

                        <div>
                            <label style="padding-right:30px">Up:</label>
                            <select keyboardButton name="up" onchange="window.updateKeyboardMapping(this.value, this.name)"></select>
                        </div>

                        <div>
                            <label style="padding-right:40px">Down:</label>
                            <select keyboardButton name="down" onchange="window.updateKeyboardMapping(this.value, this.name)"></select>
                        </div>

                        <div>
                            
                            <label style="padding-right:20px">Left:</label>
                            <select keyboardButton name="left" onchange="window.updateKeyboardMapping(this.value, this.name)"></select>
                        </div>

                        <div>
                            <label style="padding-right:30px">Right:</label>
                            <select keyboardButton name="right" onchange="window.updateKeyboardMapping(this.value, this.name)"></select>
                        </div>
                </div>

                <div style="float: right;">
                        <div>
                            <label style="padding-right:30px">C-Up:</label>
                            <select keyboardButton name="cu" onchange="window.updateKeyboardMapping(this.value, this.name)"></select>
                        </div>

                        <div>
                            <label style="padding-right:40px">C-Down:</label>
                            <select keyboardButton name="cd" onchange="window.updateKeyboardMapping(this.value, this.name)"></select>
                        </div>

                        <div>
                            <label style="padding-right:20px">C-Left:</label>
                            <select keyboardButton name="cl" onchange="window.updateKeyboardMapping(this.value, this.name)"></select>
                        </div>

                        <div>
                            <label style="padding-right:30px">C-Right:</label>
                            <select keyboardButton name="cr" onchange="window.updateKeyboardMapping(this.value, this.name)"></select>
                        </div>

                        <div>
                            <label style="padding-right:30px">Minimap:</label>
                            <select keyboardButton name="map" onchange="window.updateKeyboardMapping(this.value, this.name)"></select>
                        </div>

                        <div>
                            <label style="padding-right:30px">Taunt Wheel:</label>
                            <select keyboardButton name="taunt" onchange="window.updateKeyboardMapping(this.value, this.name)"></select>
                        </div>

                        <div>
                            <label style="padding-right:30px">Glider:</label>
                            <select keyboardButton name="parachute" onchange="window.updateKeyboardMapping(this.value, this.name)"></select>
                        </div>

                        <div>
                            <label style="padding-right:30px">Chat:</label>
                            <select keyboardButton name="chat" onchange="window.updateKeyboardMapping(this.value, this.name)"></select>
                        </div>
                </div>

            </div>

            <hr style="width: 50%; color: white; border: 0.2em solid white;">

            <!-- Gamepad controls pop up -->
            <div id="gamepadControlsWindow">
                <!-- Gamepad message -->
                <div>
                    <div hidden id="gamepadMessageDiv">
                        <h6 id="gamepadMessage">
                        </h6>
                        <h6 style="text-align:center" id="gamepadMessage">
                            Is your gamepad not working correctly?
                            <br />
                            Contact me so I can support more gamepads. Discord: snuffysasa#2779 /
                            <a href="https://github.com/sm64js/sm64js/issues" style="color:lightblue;font-weight:bold">Github</a>
                        </h6>
                    </div>

                </div>

                <!-- Gamepad controls list -->

                <div>
                    <form>
                        <div>
                            <label style="padding-right:30px">Start:</label>
                            <select gamepadButton name="start" onchange="window.updateGamepadMapping(this.value, this.name)"></select>
                        </div>
                        <div>
                            <label style="padding-right:30px">A:</label>
                            <select gamepadButton name="a" onchange="window.updateGamepadMapping(this.value, this.name)"></select>
                        </div>
                        <div>
                            <label style="padding-right:30px">B:</label>
                            <select gamepadButton name="b" onchange="window.updateGamepadMapping(this.value, this.name)"></select>
                        </div>
                        <div>
                            <label style="padding-right:30px">Z:</label>
                            <select gamepadButton name="z" onchange="window.updateGamepadMapping(this.value, this.name)"></select>
                        </div>
                        <div>
                            <label style="padding-right:30px">axisX:</label>
                            <select gamepadAxes name="stickX" onchange="window.updateGamepadMapping(this.value, this.name)"></select>
                        </div>

                        <div>
                            <label style="padding-right:30px">axisY:</label>
                            <select gamepadAxes name="stickY" onchange="window.updateGamepadMapping(this.value, this.name)"></select>
                        </div>
                    </form>
                </div>

                <div>
                    <form>

                        <div>
                            <label style="padding-right:30px">C-axisX:</label>
                            <select gamepadAxes name="cStickX" onchange="window.updateGamepadMapping(this.value, this.name)"></select>
                        </div>

                        <div>
                            <label style="padding-right:30px">C-axisY:</label>
                            <select gamepadAxes name="cStickY" onchange="window.updateGamepadMapping(this.value, this.name)"></select>
                        </div>

                        <div>
                            <label style="padding-right:50px">deadZone:</label>
                            <input type="number" style="width:70px;" value="0.3" min="0" max="1" step="0.01" class="form-control" onchange="window.updateDeadZone(this.value)">
                        </div>

                        <div>
                            <label style="padding-right:30px">Minimap:</label>
                            <select gamepadButton name="map" onchange="window.updateGamepadMapping(this.value, this.name)"></select>
                        </div>

                        <div>
                            <label style="padding-right:30px">Taunt Wheel:</label>
                            <select gamepadButton name="taunt" onchange="window.updateGamepadMapping(this.value, this.name)"></select>
                        </div>

                        <div>
                            <label style="padding-right:30px">Glider:</label>
                            <select gamepadButton name="parachute" onchange="window.updateGamepadMapping(this.value, this.name)"></select>
                        </div>
                    </form>

                </div>
            </div>
            <!-- Save & reset controls button -->
            <div class="controlButtons">
                <button class="green-button" style="margin-right:30px" onclick="window.saveControls()">Save Controls</button>
                <button class="red-button fixButtonPadding" onclick="window.loadDefaultControls()">Load Default Controls</button>
            </div>
            <!-- Controls and customization -->
            <div id="greenControls">
                <button type="button"
                        class="yellow-button"
                        data-placement="bottom"
                        onclick="window.switchbox()">
                    Return
                </button>
                <button type="button"
                        class="blue-button"
                        onclick="window.switchbox('optionsbox')">
                    Options & Misc
                </button>
                <button type="button"
                    class="pink-button fixButtonPadding"
                    onclick="window.switchbox('customizebox'); window.updateWheel()">
                    Customize Character / Skin
                </button>
            </div>
        </div>

        <br>
        <!-- Game canvas section -->
        <div class="gameCanvasSection">
            <div style="float:left">
                <!-- Game canvas -->
                <div class="relativePositioner">
                    <canvas id="textCanvas"></canvas>
                    <canvas id="gameCanvas" width="1280" height="720"></canvas>
                </div>
            </div>
            <div class="gameCanvasRight" style="float:right">
                <!-- Chat container -->
                <div class="chatContainer">
                        <ul id="chatlog"></ul>

                        <input id="chatbox" class="chatbox" type="text" autocomplete="off" maxlength="100" placeholder="Chat box, to block someone type '/block username'">

                </div>
            </div>
        </div>

            <!-- Disconnected from the game/server message -->
            <h6 hidden id="connectedMsg" style="color:red;">Not connected to server - Refresh the page</h6>

        </div>
        <!-- End of game canvas -->

        <!-- Music section -->
        <div class="musicDiv">
            <h1>Music</h1>
            <div>
                <!-- Snow Mountain DX by eros71 -->
                <div class="musicBox">
                        <h5 class="musicTitles">Snow Mountain DX by eros71</h5>

                        <audio controls loop>
                        <source src="https://sm64js.nyc3.cdn.digitaloceanspaces.com/sm64js-music/Snow%20Mountain%20DX.wav" type="audio/wav">
                        Your browser does not support the audio element.
                        </audio>
                </div>
                <!-- Snow Mountain DX by eros71 -->
                <div class="musicBox">
                        <h5 class="musicTitles">Peaceful Bob-omb Fields by eros71</h5>

                        <audio controls loop>
                        <source src="https://sm64js.nyc3.cdn.digitaloceanspaces.com/sm64js-music/Bob-omb%20Peaceful-Field.wav" type="audio/wav">
                        Your browser does not support the audio element.
                        </audio>
                </div>
                <!-- Snow Mountain DX by eros71 -->
                <div class="musicBox">
                        <h5 class="musicTitles">Mario Filled Field by Belgium</h5>

                        <audio controls loop>
                        <source src="https://sm64js.nyc3.cdn.digitaloceanspaces.com/sm64js-music/Mario%20Filled%20Field.mp3" type="audio/wav">
                        Your browser does not support the audio element.
                        </audio>
                </div>
                <!-- Snow Mountain DX by eros71 -->
                <div class="musicBox">
                        <h5 class="musicTitles">SM64JS File Select Remix by Subject to Change</h5>

                        <audio controls loop>
                        <source src="https://sm64js.nyc3.cdn.digitaloceanspaces.com/sm64js-music/SM64JS%20File%20Select%20Remix.wav" type="audio/wav">
                        Your browser does not support the audio element.
                        </audio>
                </div>
            </div>
        </div>
        <!-- End of Music section-->
        <br />
        <br />
    </main>
</body>
</html>
